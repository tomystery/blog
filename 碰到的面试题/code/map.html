<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
  <!-- <script src="./map-递归.js"></script> -->
  <!-- <script src="./map.js"></script> -->
  <script>
    const mapA = [
      [1, 0, 1, 0],
      [1, 1, 0, 0],
      [1, 0, 0, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 0],
    ];

    function map(map) {
      let rows = map.length;
      let cols = map[0].length;
      let result = false; //返回是正确的还是错误的
      let allIndex = []; //我走过的
      let curIndex = []; //我现在走的

      let step = 0; //我走的步数
      while (true) {
        if (step === 0) {
          curIndex = map.reduce((prev, [row, col], i) => {
            console.log([row, col]);
            if (row === 0 && col === 0) {
              prev.push({ row: i, col: 1, filter: "left" });
            }
            return prev;
          }, []);
        } else {
          curIndex = curIndex.reduce((prev, { row, col, filter }) => {
            if (col === cols - 1) {
              result = true;
              break;
            }
            //找出上面的有没有 row -1 ,col
            if (map[row - 1][col] === 0 && filter !== "top") {
              //我当前这个元素是不是从上面下来的
              prev.push({ row: row - 1, col, filter: "bottom" });
            }

            //找出下面的有没有 row + 1 ,col
            if (map[row + 1][col] === 0 && filter !== "bottom") {
              prev.push({ row: row + 1, col, filter: "top" });
            }

            //找出左边有没有 row ，col-1,我自己是不是从左边来的
            if (map[row][col - 1] === 0 && filter !== "left") {
              prev.push({ row: row, col: col - 1, filter: "right" });
            }

            if (map[row][col + 1] === 0 && filter !== "right") {
              prev.push({ row: row, col: col + 1, filter: "left" });
            }
            return prev;
          }, []);
        }
        //排除走过的节点
        curIndex = curIndex.filter(({ row, col }) => {
          !allIndex.find((item) => item.row === row && item.col === col);
        });
        allIndex = allIndex.concat(curIndex);
        step++;
      }
      console.log("curIndex:", curIndex);
    }
    console.log(map(mapA));
  </script>
</html>
